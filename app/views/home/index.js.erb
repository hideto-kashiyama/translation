  
  //helpers/home_helper.rb  translate英訳　translatej 和訳
   if (gid) {
       var transtext="<%= translate %>";
       
     } else {
     
        var transtext="<%= translatej%>";
     }  
 
 var txt=transtext.replace( /&amp;#39;/g , "'" );

 $('#txtTarget').val(txt);
 
  
   var text =  $('#txtTarget').val();
 
    var uttr = new SpeechSynthesisUtterance();
    uttr.text = text;
    
    if (gid) {
       uttr.lang = 'en-US';
        speechSynthesis.speak(uttr);
     } else {
     
      var radio_sp= $("input[name='sp']:checked").val();　//日本語音声選択値 0 :AITalk 2 :google
         
         if ( radio_sp==2 ) {
             
           uttr.lang = 'ja-JP';
           speechSynthesis.speak(uttr);
          
          } else {
          
            $("#aimbtn").click();//AITalk ruby音声合成
          
         }   

     }
     
     uttr.onend = function (event) {
        console.log('喋った時間：' + event.elapsedTime + 's');
        var tm =event.elapsedTime *10
        console.log(parseInt(tm)+100);
            setTimeout(function(){
                console.log('終了' + $("#txtTarget").val().length);
                var cnt =$("#txtTarget").val().length
                console.log(cnt)
                var gcnt = $('#gcnt').val();
                
                   if (gcnt==0) {
                       
                     $("#gcnt").val(cnt);
                     
                   } else {
                       
                       $('#gcnt').val(parseInt(cnt) + parseInt(gcnt));
                     
                   }
                   
                    $.cookie('g_cookie', $('#gcnt').val()); 
            
             },parseInt(tm)+100);
 
    }

     
		
 <%= atk %>
 


 

